Q3 / 2025-10-13

# 데이터베이스 설계서

**작성일**: 2025-10-13  
**문서명**: 251013_설계 - 데이터베이스 설계서 v1.0.md  
**프로젝트**: 스마트 단어장 (Smart Vocabulary Builder)  
**설계자**: AI Software Student Team

---

## 1. 데이터 항목 정의 (Data Dictionary)

### 1.1 공통 데이터 항목

| 항목명(영문) | 항목명(한글) | 데이터 타입 | 길이 | 설명 | 비고 |
|------------|------------|-----------|------|------|------|
| id | 식별자 | INTEGER | - | 고유 식별자 | AUTO_INCREMENT |
| created_date | 생성일시 | TEXT | 23 | 데이터 생성 일시 | ISO 8601 형식 |
| modified_date | 수정일시 | TEXT | 23 | 데이터 수정 일시 | ISO 8601 형식 |
| is_deleted | 삭제여부 | INTEGER | 1 | 논리 삭제 여부 | 0: 미삭제, 1: 삭제 |

---

### 1.2 단어 관련 데이터 항목

| 항목명(영문) | 항목명(한글) | 데이터 타입 | 길이 | 설명 | 비고 |
|------------|------------|-----------|------|------|------|
| word_id | 단어ID | INTEGER | - | 단어 고유 식별자 | PK |
| english | 영어단어 | TEXT | 100 | 영어 단어 | NOT NULL |
| korean | 한국어뜻 | TEXT | 200 | 한국어 뜻 | NOT NULL |
| memo | 메모 | TEXT | 500 | 개인 학습 메모 | NULL 허용 |
| is_favorite | 즐겨찾기여부 | INTEGER | 1 | 즐겨찾기 여부 | 0: 미등록, 1: 등록 |
| pronunciation | 발음기호 | TEXT | 100 | IPA 발음기호 | NULL 허용, 향후 기능 |
| example_sentence | 예문 | TEXT | 500 | 단어 사용 예문 | NULL 허용, 향후 기능 |

---

### 1.3 학습 관련 데이터 항목

| 항목명(영문) | 항목명(한글) | 데이터 타입 | 길이 | 설명 | 비고 |
|------------|------------|-----------|------|------|------|
| history_id | 학습이력ID | INTEGER | - | 학습 이력 고유 식별자 | PK |
| session_id | 세션ID | INTEGER | - | 학습 세션 식별자 | FK |
| word_id | 단어ID | INTEGER | - | 학습한 단어 ID | FK |
| study_date | 학습일시 | TEXT | 23 | 학습 일시 | ISO 8601 |
| study_mode | 학습모드 | TEXT | 20 | 학습 유형 | flashcard_en_ko, flashcard_ko_en |
| is_correct | 정답여부 | INTEGER | 1 | 정답 여부 | 0: 오답, 1: 정답 |
| response_time | 응답시간 | REAL | - | 응답 소요 시간(초) | NULL 허용 |
| user_answer | 사용자답변 | TEXT | 200 | 사용자가 입력한 답 | NULL 허용 |

---

### 1.4 학습 세션 데이터 항목

| 항목명(영문) | 항목명(한글) | 데이터 타입 | 길이 | 설명 | 비고 |
|------------|------------|-----------|------|------|------|
| session_id | 세션ID | INTEGER | - | 세션 고유 식별자 | PK |
| session_type | 세션유형 | TEXT | 20 | 세션 유형 | flashcard, exam |
| start_time | 시작시간 | TEXT | 23 | 세션 시작 시간 | ISO 8601 |
| end_time | 종료시간 | TEXT | 23 | 세션 종료 시간 | ISO 8601, NULL 허용 |
| total_words | 총단어수 | INTEGER | - | 학습한 총 단어 수 | 0 이상 |
| correct_count | 정답수 | INTEGER | - | 정답 개수 | 0 이상 |
| wrong_count | 오답수 | INTEGER | - | 오답 개수 | 0 이상 |
| accuracy_rate | 정답률 | REAL | - | 정답률(%) | 0.0 ~ 100.0 |
| study_mode | 학습모드 | TEXT | 20 | 출제 방식 | sequential, random, personalized |

---

### 1.5 통계 관련 데이터 항목

| 항목명(영문) | 항목명(한글) | 데이터 타입 | 길이 | 설명 | 비고 |
|------------|------------|-----------|------|------|------|
| word_id | 단어ID | INTEGER | - | 단어 ID | PK, FK |
| total_attempts | 총시도횟수 | INTEGER | - | 총 학습 시도 횟수 | 0 이상 |
| correct_count | 정답횟수 | INTEGER | - | 정답 횟수 | 0 이상 |
| wrong_count | 오답횟수 | INTEGER | - | 오답 횟수 | 0 이상 |
| wrong_rate | 오답률 | REAL | - | 오답률(%) | 0.0 ~ 100.0 |
| last_study_date | 최종학습일 | TEXT | 23 | 마지막 학습 일시 | ISO 8601 |
| next_review_date | 다음복습일 | TEXT | 23 | 다음 복습 예정일 | ISO 8601, NULL 허용 |
| mastery_level | 숙지도 | INTEGER | 1 | 숙지 수준 | 0~5 (0: 미학습, 5: 완전숙지) |
| consecutive_correct | 연속정답수 | INTEGER | - | 연속으로 맞춘 횟수 | 0 이상 |

---

### 1.6 시험 관련 데이터 항목

| 항목명(영문) | 항목명(한글) | 데이터 타입 | 길이 | 설명 | 비고 |
|------------|------------|-----------|------|------|------|
| exam_id | 시험ID | INTEGER | - | 시험 고유 식별자 | PK |
| exam_date | 시험일시 | TEXT | 23 | 시험 일시 | ISO 8601 |
| exam_type | 시험유형 | TEXT | 20 | 시험 문제 유형 | short_answer, multiple_choice |
| question_mode | 출제모드 | TEXT | 20 | 출제 방식 | en_to_ko, ko_to_en |
| total_questions | 총문항수 | INTEGER | - | 총 문항 수 | 1 이상 |
| correct_count | 정답수 | INTEGER | - | 정답 개수 | 0 이상 |
| wrong_count | 오답수 | INTEGER | - | 오답 개수 | 0 이상 |
| score | 점수 | REAL | - | 점수(정답률 %) | 0.0 ~ 100.0 |
| time_taken | 소요시간 | INTEGER | - | 시험 소요 시간(초) | 0 이상 |
| time_limit | 제한시간 | INTEGER | - | 설정한 제한 시간(초) | NULL 허용 |

---

### 1.7 시험 문제 상세 데이터 항목

| 항목명(영문) | 항목명(한글) | 데이터 타입 | 길이 | 설명 | 비고 |
|------------|------------|-----------|------|------|------|
| question_id | 문제ID | INTEGER | - | 문제 고유 식별자 | PK |
| exam_id | 시험ID | INTEGER | - | 시험 ID | FK |
| word_id | 단어ID | INTEGER | - | 출제된 단어 ID | FK |
| question_number | 문제번호 | INTEGER | - | 문제 순서 | 1 이상 |
| user_answer | 사용자답변 | TEXT | 200 | 사용자가 입력/선택한 답 | NULL 허용 |
| correct_answer | 정답 | TEXT | 200 | 정답 | NOT NULL |
| is_correct | 정답여부 | INTEGER | 1 | 정답 여부 | 0: 오답, 1: 정답 |
| response_time | 응답시간 | REAL | - | 문제당 응답 시간(초) | NULL 허용 |
| choices | 선택지 | TEXT | 500 | 객관식 선택지(JSON) | NULL 허용, 객관식만 |

---

### 1.8 오답 노트 데이터 항목

| 항목명(영문) | 항목명(한글) | 데이터 타입 | 길이 | 설명 | 비고 |
|------------|------------|-----------|------|------|------|
| note_id | 오답노트ID | INTEGER | - | 오답 노트 고유 식별자 | PK |
| word_id | 단어ID | INTEGER | - | 틀린 단어 ID | FK |
| exam_id | 시험ID | INTEGER | - | 틀렸던 시험 ID | FK, NULL 허용 |
| added_date | 추가일시 | TEXT | 23 | 오답 노트 추가 일시 | ISO 8601 |
| is_resolved | 해결여부 | INTEGER | 1 | 숙지 완료 여부 | 0: 미해결, 1: 해결 |
| resolved_date | 해결일시 | TEXT | 23 | 숙지 완료 일시 | ISO 8601, NULL 허용 |
| wrong_count | 오답횟수 | INTEGER | - | 해당 단어 오답 누적 횟수 | 1 이상 |

---

### 1.9 사용자 설정 데이터 항목

| 항목명(영문) | 항목명(한글) | 데이터 타입 | 길이 | 설명 | 비고 |
|------------|------------|-----------|------|------|------|
| setting_id | 설정ID | INTEGER | - | 설정 고유 식별자 | PK |
| setting_key | 설정키 | TEXT | 50 | 설정 항목 키 | UNIQUE, NOT NULL |
| setting_value | 설정값 | TEXT | 200 | 설정 값 | NOT NULL |
| setting_type | 설정타입 | TEXT | 20 | 설정 데이터 타입 | string, integer, boolean, float |
| description | 설명 | TEXT | 200 | 설정 항목 설명 | NULL 허용 |
| modified_date | 수정일시 | TEXT | 23 | 설정 수정 일시 | ISO 8601 |

---

## 2. 테이블 스키마 정의

### 2.1 words (단어 정보 테이블)

**테이블 설명**: 사용자가 학습하는 영어 단어와 한국어 뜻을 저장하는 마스터 테이블

**테이블 스키마**:
```sql
CREATE TABLE words (
    word_id INTEGER PRIMARY KEY AUTOINCREMENT,
    english TEXT NOT NULL,
    korean TEXT NOT NULL,
    memo TEXT,
    is_favorite INTEGER DEFAULT 0 CHECK(is_favorite IN (0, 1)),
    pronunciation TEXT,
    example_sentence TEXT,
    created_date TEXT NOT NULL,
    modified_date TEXT,
    UNIQUE(english, korean)
);
```

**컬럼 상세**:
| 컬럼명 | 타입 | 제약조건 | 설명 |
|--------|------|---------|------|
| word_id | INTEGER | PK, AUTOINCREMENT | 단어 고유 식별자 |
| english | TEXT | NOT NULL | 영어 단어 (예: "apple") |
| korean | TEXT | NOT NULL | 한국어 뜻 (예: "사과") |
| memo | TEXT | NULL | 개인 학습 메모 |
| is_favorite | INTEGER | DEFAULT 0, CHECK | 즐겨찾기 여부 (0 또는 1) |
| pronunciation | TEXT | NULL | IPA 발음기호 (향후 기능) |
| example_sentence | TEXT | NULL | 예문 (향후 기능) |
| created_date | TEXT | NOT NULL | 생성 일시 (ISO 8601) |
| modified_date | TEXT | NULL | 수정 일시 (ISO 8601) |

**인덱스**:
```sql
CREATE INDEX idx_words_english ON words(english);
CREATE INDEX idx_words_favorite ON words(is_favorite);
```

**샘플 데이터**:
```sql
INSERT INTO words (english, korean, memo, is_favorite, created_date) VALUES
('apple', '사과', '과일 종류, red apple은 빨간 사과', 1, '2025-10-13T10:00:00'),
('book', '책', '읽는 것', 0, '2025-10-13T10:05:00'),
('computer', '컴퓨터', '전자기기, IT 관련', 1, '2025-10-13T10:10:00');
```

---

### 2.2 learning_sessions (학습 세션 테이블)

**테이블 설명**: 플래시카드 학습의 각 세션 정보를 기록하는 테이블 (세션 단위 통계)

**테이블 스키마**:
```sql
CREATE TABLE learning_sessions (
    session_id INTEGER PRIMARY KEY AUTOINCREMENT,
    session_type TEXT NOT NULL CHECK(session_type IN ('flashcard', 'exam')),
    start_time TEXT NOT NULL,
    end_time TEXT,
    total_words INTEGER DEFAULT 0 CHECK(total_words >= 0),
    correct_count INTEGER DEFAULT 0 CHECK(correct_count >= 0),
    wrong_count INTEGER DEFAULT 0 CHECK(wrong_count >= 0),
    accuracy_rate REAL DEFAULT 0.0 CHECK(accuracy_rate >= 0.0 AND accuracy_rate <= 100.0),
    study_mode TEXT CHECK(study_mode IN ('sequential', 'random', 'personalized'))
);
```

**컬럼 상세**:
| 컬럼명 | 타입 | 제약조건 | 설명 |
|--------|------|---------|------|
| session_id | INTEGER | PK, AUTOINCREMENT | 세션 고유 식별자 |
| session_type | TEXT | NOT NULL, CHECK | 세션 유형 (flashcard, exam) |
| start_time | TEXT | NOT NULL | 세션 시작 시간 |
| end_time | TEXT | NULL | 세션 종료 시간 |
| total_words | INTEGER | DEFAULT 0, CHECK | 학습한 총 단어 수 |
| correct_count | INTEGER | DEFAULT 0, CHECK | 정답 개수 |
| wrong_count | INTEGER | DEFAULT 0, CHECK | 오답 개수 |
| accuracy_rate | REAL | DEFAULT 0.0, CHECK | 정답률 (0.0 ~ 100.0) |
| study_mode | TEXT | CHECK | 출제 방식 (sequential, random, personalized) |

**인덱스**:
```sql
CREATE INDEX idx_sessions_start_time ON learning_sessions(start_time);
CREATE INDEX idx_sessions_type ON learning_sessions(session_type);
```

**샘플 데이터**:
```sql
INSERT INTO learning_sessions (session_type, start_time, end_time, total_words, correct_count, wrong_count, accuracy_rate, study_mode) VALUES
('flashcard', '2025-10-13T14:00:00', '2025-10-13T14:15:00', 20, 15, 5, 75.0, 'personalized'),
('flashcard', '2025-10-13T20:00:00', '2025-10-13T20:30:00', 30, 25, 5, 83.33, 'random');
```

---

### 2.3 learning_history (학습 이력 테이블)

**테이블 설명**: 각 단어의 개별 학습 이력을 상세히 기록하는 테이블 (단어별, 학습별 기록)

**테이블 스키마**:
```sql
CREATE TABLE learning_history (
    history_id INTEGER PRIMARY KEY AUTOINCREMENT,
    session_id INTEGER NOT NULL,
    word_id INTEGER NOT NULL,
    study_date TEXT NOT NULL,
    study_mode TEXT NOT NULL CHECK(study_mode IN ('flashcard_en_ko', 'flashcard_ko_en', 'exam_en_ko', 'exam_ko_en')),
    is_correct INTEGER NOT NULL CHECK(is_correct IN (0, 1)),
    response_time REAL,
    user_answer TEXT,
    FOREIGN KEY (session_id) REFERENCES learning_sessions(session_id) ON DELETE CASCADE,
    FOREIGN KEY (word_id) REFERENCES words(word_id) ON DELETE CASCADE
);
```

**컬럼 상세**:
| 컬럼명 | 타입 | 제약조건 | 설명 |
|--------|------|---------|------|
| history_id | INTEGER | PK, AUTOINCREMENT | 학습 이력 고유 식별자 |
| session_id | INTEGER | FK, NOT NULL | 학습 세션 ID |
| word_id | INTEGER | FK, NOT NULL | 학습한 단어 ID |
| study_date | TEXT | NOT NULL | 학습 일시 |
| study_mode | TEXT | NOT NULL, CHECK | 학습 모드 (영→한, 한→영) |
| is_correct | INTEGER | NOT NULL, CHECK | 정답 여부 (0: 오답, 1: 정답) |
| response_time | REAL | NULL | 응답 소요 시간(초) |
| user_answer | TEXT | NULL | 사용자 답변 (오답 분석용) |

**인덱스**:
```sql
CREATE INDEX idx_history_word_id ON learning_history(word_id);
CREATE INDEX idx_history_study_date ON learning_history(study_date);
CREATE INDEX idx_history_session_id ON learning_history(session_id);
```

**샘플 데이터**:
```sql
INSERT INTO learning_history (session_id, word_id, study_date, study_mode, is_correct, response_time, user_answer) VALUES
(1, 1, '2025-10-13T14:01:00', 'flashcard_en_ko', 1, 2.5, '사과'),
(1, 2, '2025-10-13T14:02:30', 'flashcard_en_ko', 0, 5.0, '책상'),
(1, 3, '2025-10-13T14:04:00', 'flashcard_en_ko', 1, 3.2, '컴퓨터');
```

---

### 2.4 word_statistics (단어별 통계 테이블)

**테이블 설명**: 각 단어의 학습 통계를 집계하여 저장하는 테이블 (성능 최적화)

**테이블 스키마**:
```sql
CREATE TABLE word_statistics (
    word_id INTEGER PRIMARY KEY,
    total_attempts INTEGER DEFAULT 0 CHECK(total_attempts >= 0),
    correct_count INTEGER DEFAULT 0 CHECK(correct_count >= 0),
    wrong_count INTEGER DEFAULT 0 CHECK(wrong_count >= 0),
    wrong_rate REAL DEFAULT 0.0 CHECK(wrong_rate >= 0.0 AND wrong_rate <= 100.0),
    last_study_date TEXT,
    next_review_date TEXT,
    mastery_level INTEGER DEFAULT 0 CHECK(mastery_level >= 0 AND mastery_level <= 5),
    consecutive_correct INTEGER DEFAULT 0 CHECK(consecutive_correct >= 0),
    FOREIGN KEY (word_id) REFERENCES words(word_id) ON DELETE CASCADE
);
```

**컬럼 상세**:
| 컬럼명 | 타입 | 제약조건 | 설명 |
|--------|------|---------|------|
| word_id | INTEGER | PK, FK | 단어 ID |
| total_attempts | INTEGER | DEFAULT 0, CHECK | 총 학습 시도 횟수 |
| correct_count | INTEGER | DEFAULT 0, CHECK | 정답 횟수 |
| wrong_count | INTEGER | DEFAULT 0, CHECK | 오답 횟수 |
| wrong_rate | REAL | DEFAULT 0.0, CHECK | 오답률 (%) |
| last_study_date | TEXT | NULL | 마지막 학습 일시 |
| next_review_date | TEXT | NULL | 다음 복습 예정일 (향후 간격 반복 기능) |
| mastery_level | INTEGER | DEFAULT 0, CHECK | 숙지 수준 (0~5) |
| consecutive_correct | INTEGER | DEFAULT 0, CHECK | 연속 정답 횟수 |

**인덱스**:
```sql
CREATE INDEX idx_stats_wrong_rate ON word_statistics(wrong_rate DESC);
CREATE INDEX idx_stats_last_study ON word_statistics(last_study_date);
CREATE INDEX idx_stats_mastery ON word_statistics(mastery_level);
```

**샘플 데이터**:
```sql
INSERT INTO word_statistics (word_id, total_attempts, correct_count, wrong_count, wrong_rate, last_study_date, mastery_level, consecutive_correct) VALUES
(1, 10, 8, 2, 20.0, '2025-10-13T14:01:00', 4, 3),
(2, 8, 4, 4, 50.0, '2025-10-13T14:02:30', 2, 0),
(3, 12, 11, 1, 8.33, '2025-10-13T14:04:00', 5, 5);
```

---

### 2.5 exam_history (시험 이력 테이블)

**테이블 설명**: 시험 전체의 결과를 기록하는 테이블 (시험 단위 통계)

**테이블 스키마**:
```sql
CREATE TABLE exam_history (
    exam_id INTEGER PRIMARY KEY AUTOINCREMENT,
    exam_date TEXT NOT NULL,
    exam_type TEXT NOT NULL CHECK(exam_type IN ('short_answer', 'multiple_choice')),
    question_mode TEXT NOT NULL CHECK(question_mode IN ('en_to_ko', 'ko_to_en', 'mixed')),
    total_questions INTEGER NOT NULL CHECK(total_questions > 0),
    correct_count INTEGER DEFAULT 0 CHECK(correct_count >= 0),
    wrong_count INTEGER DEFAULT 0 CHECK(wrong_count >= 0),
    score REAL NOT NULL CHECK(score >= 0.0 AND score <= 100.0),
    time_taken INTEGER CHECK(time_taken >= 0),
    time_limit INTEGER
);
```

**컬럼 상세**:
| 컬럼명 | 타입 | 제약조건 | 설명 |
|--------|------|---------|------|
| exam_id | INTEGER | PK, AUTOINCREMENT | 시험 고유 식별자 |
| exam_date | TEXT | NOT NULL | 시험 일시 |
| exam_type | TEXT | NOT NULL, CHECK | 시험 유형 (단답형, 객관식) |
| question_mode | TEXT | NOT NULL, CHECK | 출제 모드 (영→한, 한→영, 혼합) |
| total_questions | INTEGER | NOT NULL, CHECK | 총 문항 수 |
| correct_count | INTEGER | DEFAULT 0, CHECK | 정답 개수 |
| wrong_count | INTEGER | DEFAULT 0, CHECK | 오답 개수 |
| score | REAL | NOT NULL, CHECK | 점수 (정답률 %) |
| time_taken | INTEGER | CHECK | 시험 소요 시간 (초) |
| time_limit | INTEGER | NULL | 설정한 제한 시간 (초) |

**인덱스**:
```sql
CREATE INDEX idx_exam_date ON exam_history(exam_date);
CREATE INDEX idx_exam_score ON exam_history(score DESC);
```

**샘플 데이터**:
```sql
INSERT INTO exam_history (exam_date, exam_type, question_mode, total_questions, correct_count, wrong_count, score, time_taken, time_limit) VALUES
('2025-10-13T16:00:00', 'short_answer', 'en_to_ko', 20, 16, 4, 80.0, 600, 1200),
('2025-10-13T18:00:00', 'multiple_choice', 'ko_to_en', 30, 27, 3, 90.0, 900, NULL);
```

---

### 2.6 exam_questions (시험 문제 상세 테이블)

**테이블 설명**: 시험의 각 문제별 상세 정보를 기록하는 테이블 (문제별 정답/오답 분석)

**테이블 스키마**:
```sql
CREATE TABLE exam_questions (
    question_id INTEGER PRIMARY KEY AUTOINCREMENT,
    exam_id INTEGER NOT NULL,
    word_id INTEGER NOT NULL,
    question_number INTEGER NOT NULL CHECK(question_number > 0),
    user_answer TEXT,
    correct_answer TEXT NOT NULL,
    is_correct INTEGER NOT NULL CHECK(is_correct IN (0, 1)),
    response_time REAL,
    choices TEXT,
    FOREIGN KEY (exam_id) REFERENCES exam_history(exam_id) ON DELETE CASCADE,
    FOREIGN KEY (word_id) REFERENCES words(word_id) ON DELETE CASCADE,
    UNIQUE(exam_id, question_number)
);
```

**컬럼 상세**:
| 컬럼명 | 타입 | 제약조건 | 설명 |
|--------|------|---------|------|
| question_id | INTEGER | PK, AUTOINCREMENT | 문제 고유 식별자 |
| exam_id | INTEGER | FK, NOT NULL | 시험 ID |
| word_id | INTEGER | FK, NOT NULL | 출제된 단어 ID |
| question_number | INTEGER | NOT NULL, CHECK | 문제 순서 (1번, 2번...) |
| user_answer | TEXT | NULL | 사용자가 입력/선택한 답 |
| correct_answer | TEXT | NOT NULL | 정답 |
| is_correct | INTEGER | NOT NULL, CHECK | 정답 여부 (0: 오답, 1: 정답) |
| response_time | REAL | NULL | 문제당 응답 시간 (초) |
| choices | TEXT | NULL | 객관식 선택지 (JSON 형식) |

**인덱스**:
```sql
CREATE INDEX idx_questions_exam_id ON exam_questions(exam_id);
CREATE INDEX idx_questions_word_id ON exam_questions(word_id);
CREATE INDEX idx_questions_correct ON exam_questions(is_correct);
```

**샘플 데이터**:
```sql
INSERT INTO exam_questions (exam_id, word_id, question_number, user_answer, correct_answer, is_correct, response_time, choices) VALUES
(1, 1, 1, '사과', '사과', 1, 3.5, NULL),
(1, 2, 2, '책상', '책', 0, 5.2, NULL),
(2, 3, 1, '컴퓨터', '컴퓨터', 1, 2.8, '["컴퓨터", "계산기", "모니터", "키보드"]');
```

**choices 컬럼 JSON 형식 예시**:
```json
["사과", "배", "바나나", "포도"]
```

---

### 2.7 wrong_note (오답 노트 테이블)

**테이블 설명**: 시험에서 틀린 단어를 자동으로 기록하고 관리하는 테이블

**테이블 스키마**:
```sql
CREATE TABLE wrong_note (
    note_id INTEGER PRIMARY KEY AUTOINCREMENT,
    word_id INTEGER NOT NULL,
    exam_id INTEGER,
    added_date TEXT NOT NULL,
    is_resolved INTEGER DEFAULT 0 CHECK(is_resolved IN (0, 1)),
    resolved_date TEXT,
    wrong_count INTEGER DEFAULT 1 CHECK(wrong_count > 0),
    FOREIGN KEY (word_id) REFERENCES words(word_id) ON DELETE CASCADE,
    FOREIGN KEY (exam_id) REFERENCES exam_history(exam_id) ON DELETE SET NULL
);
```

**컬럼 상세**:
| 컬럼명 | 타입 | 제약조건 | 설명 |
|--------|------|---------|------|
| note_id | INTEGER | PK, AUTOINCREMENT | 오답 노트 고유 식별자 |
| word_id | INTEGER | FK, NOT NULL | 틀린 단어 ID |
| exam_id | INTEGER | FK, NULL | 틀렸던 시험 ID |
| added_date | TEXT | NOT NULL | 오답 노트 추가 일시 |
| is_resolved | INTEGER | DEFAULT 0, CHECK | 숙지 완료 여부 (0: 미해결, 1: 해결) |
| resolved_date | TEXT | NULL | 숙지 완료 일시 |
| wrong_count | INTEGER | DEFAULT 1, CHECK | 해당 단어 오답 누적 횟수 |

**인덱스**:
```sql
CREATE INDEX idx_wrong_note_word_id ON wrong_note(word_id);
CREATE INDEX idx_wrong_note_resolved ON wrong_note(is_resolved);
CREATE INDEX idx_wrong_note_added_date ON wrong_note(added_date);
```

**샘플 데이터**:
```sql
INSERT INTO wrong_note (word_id, exam_id, added_date, is_resolved, resolved_date, wrong_count) VALUES
(2, 1, '2025-10-13T16:15:00', 0, NULL, 1),
(5, 1, '2025-10-13T16:15:00', 1, '2025-10-13T18:30:00', 2),
(7, 2, '2025-10-13T18:45:00', 0, NULL, 1);
```

---

### 2.8 user_settings (사용자 설정 테이블)

**테이블 설명**: 사용자의 학습 목표, UI 설정 등을 저장하는 테이블 (Key-Value 구조)

**테이블 스키마**:
```sql
CREATE TABLE user_settings (
    setting_id INTEGER PRIMARY KEY AUTOINCREMENT,
    setting_key TEXT NOT NULL UNIQUE,
    setting_value TEXT NOT NULL,
    setting_type TEXT NOT NULL CHECK(setting_type IN ('string', 'integer', 'boolean', 'float')),
    description TEXT,
    modified_date TEXT NOT NULL
);
```

**컬럼 상세**:
| 컬럼명 | 타입 | 제약조건 | 설명 |
|--------|------|---------|------|
| setting_id | INTEGER | PK, AUTOINCREMENT | 설정 고유 식별자 |
| setting_key | TEXT | NOT NULL, UNIQUE | 설정 항목 키 |
| setting_value | TEXT | NOT NULL | 설정 값 (문자열로 저장) |
| setting_type | TEXT | NOT NULL, CHECK | 데이터 타입 (string, integer, boolean, float) |
| description | TEXT | NULL | 설정 항목 설명 |
| modified_date | TEXT | NOT NULL | 설정 수정 일시 |

**인덱스**:
```sql
CREATE UNIQUE INDEX idx_settings_key ON user_settings(setting_key);
```

**샘플 데이터**:
```sql
INSERT INTO user_settings (setting_key, setting_value, setting_type, description, modified_date) VALUES
('daily_word_goal', '50', 'integer', '일일 학습 목표 단어 수', '2025-10-13T10:00:00'),
('daily_time_goal', '30', 'integer', '일일 학습 목표 시간 (분)', '2025-10-13T10:00:00'),
('flashcard_time_limit', '10', 'integer', '플래시카드 제한 시간 (초)', '2025-10-13T10:00:00'),
('exam_time_limit', '1200', 'integer', '시험 전체 제한 시간 (초)', '2025-10-13T10:00:00'),
('theme_mode', 'light', 'string', 'UI 테마 (light/dark)', '2025-10-13T10:00:00'),
('font_size', '14', 'integer', '폰트 크기', '2025-10-13T10:00:00'),
('show_pronunciation', 'false', 'boolean', '발음 기호 표시 여부', '2025-10-13T10:00:00');
```

**설정 키 정의 (주요 항목)**:
| 설정 키 | 설명 | 타입 | 기본값 |
|---------|------|------|--------|
| daily_word_goal | 일일 학습 목표 단어 수 | integer | 50 |
| daily_time_goal | 일일 학습 목표 시간 (분) | integer | 30 |
| flashcard_time_limit | 플래시카드 제한 시간 (초, 0=무제한) | integer | 0 |
| exam_time_limit | 시험 전체 제한 시간 (초, 0=무제한) | integer | 0 |
| theme_mode | UI 테마 | string | light |
| font_size | 폰트 크기 | integer | 14 |
| show_pronunciation | 발음 기호 표시 여부 | boolean | false |

---

## 3. 데이터베이스 초기화 스크립트

### 3.1 전체 테이블 생성 순서
```sql
-- 1. 단어 정보 테이블 (의존성 없음)
CREATE TABLE words (...);

-- 2. 학습 세션 테이블 (의존성 없음)
CREATE TABLE learning_sessions (...);

-- 3. 학습 이력 테이블 (words, learning_sessions에 의존)
CREATE TABLE learning_history (...);

-- 4. 단어 통계 테이블 (words에 의존)
CREATE TABLE word_statistics (...);

-- 5. 시험 이력 테이블 (의존성 없음)
CREATE TABLE exam_history (...);

-- 6. 시험 문제 상세 테이블 (exam_history, words에 의존)
CREATE TABLE exam_questions (...);

-- 7. 오답 노트 테이블 (words, exam_history에 의존)
CREATE TABLE wrong_note (...);

-- 8. 사용자 설정 테이블 (의존성 없음)
CREATE TABLE user_settings (...);
```

### 3.2 초기 설정 데이터 삽입
```sql
-- 기본 사용자 설정 삽입
INSERT INTO user_settings (setting_key, setting_value, setting_type, description, modified_date) VALUES
('daily_word_goal', '50', 'integer', '일일 학습 목표 단어 수', datetime('now')),
('daily_time_goal', '30', 'integer', '일일 학습 목표 시간 (분)', datetime('now')),
('flashcard_time_limit', '0', 'integer', '플래시카드 제한 시간 (초, 0=무제한)', datetime('now')),
('exam_time_limit', '0', 'integer', '시험 전체 제한 시간 (초, 0=무제한)', datetime('now')),
('theme_mode', 'light', 'string', 'UI 테마 (light/dark)', datetime('now')),
('font_size', '14', 'integer', '폰트 크기', datetime('now'));
```

---

## 4. 다음 단계 제안

데이터베이스 스키마 설계가 완료되었습니다. 

**다음으로 진행할 작업**:
1. **ERD 다이어그램 작성** - 테이블 간 관계를 시각화
2. **인덱스 전략 검토** - 성능 최적화를 위한 추가 인덱스 검토
3. **데이터 무결성 규칙 정리** - Trigger 필요 여부 검토
4. **시스템 아키텍처 설계** - 모듈 구조 및 계층 설계

어떤 작업부터 진행하시겠습니까?

22:45